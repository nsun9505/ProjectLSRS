# ProjectLSRS
Project Library Seat Reservation System

# Project Description
## Motivation
- 지역 도서관에서 국가근로를 하고 있음.
- COVID-19로 인해 도서관 출입 시 방명록을 적어야 함. 확진자가 다녀갈 경우 역학조사 시 자료로 사용된다.
- 하지만 한 명씩 방명록을 작성하며, 사람이 몰리게 된다면 사람이 줄지어서 기다리게 된다.
- 열람실(칸막이 책상이 있는 공부하는 곳)에 출입한 인원이 현재 얼마나 되는지 관리가 되지 않음.
- 이런 문제들을 해결하고자 프로젝트를 진행하게 되었다.

<br><br>

# Requirements
## 회원관리 기능

1. 회원은 웹 페이지에서 로그인 한다.
   - 로그인에 입력하는 것은 ID와 PW를 입력하고 로그인한다.
   - 로그인에 성공하면 서비스를 이용할 수 있다.

1. 사용자는 비회원으로 예약 시스템을 이용한다.
   - 휴대폰 인증을 통해 예약 시스템을 사용한다.

1. 처음으로 시스템을 이용하는 사용자는 회원가입을 한다.
   - 회원 가입 시 사용자는 휴대폰 인증이 가능하다.
   - 회원 가입 시 필수로 입력하는 정보는 아이디, 비밀번호, 휴대폰 번호, 이름이다.
   - 회원 가입을 완료하면 예약 시스템에 로그인하여 서비스를 이용할 수 있다.

1. 사용자는 자신의 정보를 조회할 수 있다.
   - 변경할 수 있는 부분은 비밀번호, 핸드폰 번호이다.
   - 핸드폰 번호를 변경할 경우에는 인증 절차를 거쳐야 한다.

1. 사용자는 시스템에 등록된 자신의 정보를 삭제할 수 있다.
   - 즉, 회원 탈퇴를 할 수 있다.

<br>

## 도서관 열람식 예약 기능
1. 사용자는 도서관 열람실의 자리를 예약한다.
   - 사용자당 하나의 자리만 예약이 가능하다.
   - 예약 시간은 6시간을 기본으로 한다.

1. 사용자는 이용하는 좌석의 이용시간을 연장한다.
   - 연장 시간은 6시간씩 가능하다.
   - 연장은 최대 2번만 가능하다.

1. 사용자는 열람실 자리를 반납한다.
   - 퇴실 시간 2시간 전부터 가능하다.
   - 사용자는 지정된 시간 내에 퇴실하지 않으면 경고 1회를 받는다.
   - 사용자는 퇴실 후에 다시 좌석을 예약할 수 있다.

1. 사용자는 경고가 3회 누적되면 도서관 열람식을 1일 열람이 불가능하다.

<br>

## 관리자 기능
1. 관리자는 예약을 삭제/변경한다.
   - 도서관 정책에 따라 예약을 제거 또는 변경 가능하다.

1. 관리자는 사용자 상태를 변경한다.
   - 정책에 따라 정지된 사용자의 정지 상태를 해제한다.

1. 관리자는 도서관 이용자 정보 통계를 조회한다.
   - 조회되는 정보는 개인정보이므로 회원가입 시 고지한다.

# Database Design
## Relation Schema
![텍스트](https://github.com/nsun9505/ProjectLSRS/blob/master/Relation%20Schema.jpg)

### 릴레이션 스키마 설명
#### Group
- 도서관은 속하는 그룹이 있다.
- 사용자가 A 그룹에 속하는 도서관 중 하나에 가입하면 나머지 A그룹도 이용이 가능하다.

#### LibraryGroup
- 각 도서관은 자신만의 아이디를 가진다.(PK)
- 각 도서관은 하나의 그룹에 속할 수 있다.

#### Romm
- 각 호실은 속하는 도서관의 아이디를 참조한다.
- 각 호실에는 정원이 정해져 있다.

#### Seat
- 각 좌석은 속하는 호실과 도서관을 참조하는 애트리뷰트가 있다.
- <s>처음에 고유하게 ID를 부여할까 생각했는데 나중에 많은 사람들이(100만명 이상) Reservation 테이블과 조인하여 자신의 좌석 예약 정보를 조회하는 연산을 자주하는 것보다는 하나의 테이블에 좀 더 정보를 넣는 것이 좀 더 빠를것 같아서 이렇게 설계했다.</s>
- 각 좌석을 나타내는 것은 외부에서 seatId만으로도 충분할 것 같다.
- 처음에는 따로 seatId를 애트리뷰트에 포함시키지 않았지만, 생각해보니 예약을 위해 좌석을 조회하거나, 예약된 좌석을 볼 때 조인이 일어나므로 조인에 사용되는 애트리뷰트의 수를 줄이는 것이 더 좋을 것 같아서 seatId 애트리뷰트를 추가하고 PK로 설정했다.

#### Reservation
- 실제 사용자가 예약을 했을 때 투플이 삽입된다.
- NumOfExtension은 연장 횟수를 카운트하기 위해 사용한다.

#### Return
- 사용자가 좌석 예약을 반납하거나 스케줄링 프로그램에 의해 반납될 때 저장된다.
- 이 정보를 활용하여 역학조사 가능할 것으로 본다.

#### User
- 사용자와 관리자이다.
- 관리자 가입은 만들지 않고, 관리자가 관리자를 생성할 수 있는 기능을 만들 것이다.
- enabled가 0이라면 비활성화 계정이다. 사용자의 경우 경고 누적으로 인해 정지된 계정일 것이다.

#### user_auth
- 사용자와 관리자 테이블을 나누었지만, 이를 합치기 위해 만든 테이블
- 사용자는 ROLE_USER, 관리자는 ROLE_ADMIN 값을 갖게 된다.
- 사용자와 관리자가 접근할 수 있는 페이지를 나눌 때도 사용한다.

#### auth
- 권한에 대한 정보가 담기는 테이블이다.
- 권한은 이후에 추가될 수도 있다고 생각해서 따로 생성했다.